## 题目链接
1948. 删除系统中的重复文件夹


```c++
class Solution {
public:
    struct node {
      string val;
      bool del = false;
      map<string, node*> son;
      node() {}
      node(string& v) {
        val = v;
      }
    };

    node root;
    unordered_map<string, node*> sign;

    void build_tree(node& u, vector<string>& path) {
      auto* p = &u;
      for (auto& val : path) {
        if (p->son.count(val) == 0) {
          p->son[val] = new node(val);
        }

        p = p->son[val];
      }
    }

    string dfs(node* u) {
      if (u->son.empty()) {
        return "";
      }

      string s = "(";
      for (auto& val : u->son) {
        string t = dfs(val.second);
        s.append(val.second->val);
        s.append(t);
        s.push_back(')');
      }

      if (sign.count(s)) {
        sign[s]->del = true;
        u->del = true;
      } else {
        sign[s] = u;
      }

      return s;
    }

    void dfs(node* u, vector<string>& path, vector<vector<string>>& ans) {
      if (!u) return;
      if (u->del) return;

      if (u != &root) {
        path.push_back(u->val);
        ans.push_back(path);
      }

      for (auto& val : u->son) {
        dfs(val.second, path, ans);
      }

      if (u != &root) {
        path.pop_back();
      }
    }

    vector<vector<string>> deleteDuplicateFolder(vector<vector<string>>& paths) {
      vector<vector<string>> ans;
      vector<string> path;

      for (auto& path : paths) {
        build_tree(root, path);
      }

      dfs(&root);

      dfs(&root, path, ans);

      return ans;
    }
};
```
